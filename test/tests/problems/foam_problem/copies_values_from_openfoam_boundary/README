Copied from the OpenFOAM examples (with minor changes)
