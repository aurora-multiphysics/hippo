[Tests]
    [mapped_mass_flow_receiver]
        [setup]
            type = RunCommand
            command = 'bash -c "foamCleanCase -case foam && blockMesh -case foam && decomposePar -case foam"'
        []
        [run_err]
            type = RunException
            input = main.i
            prereq = mapped_mass_flow_receiver/setup
            allow_warnings = true
            min_parallel = 5
            max_parallel = 5
            cli_args = "FoamBCs/mass_flowx/translation_vector='-0.5 0 0'"
            expect_err = "does not have a mapped plane location"
        []
        [run]
            type = RunApp
            input = main.i
            prereq = mapped_mass_flow_receiver/setup
            allow_warnings = true
            min_parallel = 5
            max_parallel = 5
        []
        [reconstruct]
            type = RunCommand
            command = 'reconstructPar -case foam'
            prereq = mapped_mass_flow_receiver/run
        []
        [verify]
            type = PythonUnitTest
            input = test.py
            prereq = mapped_mass_flow_receiver/reconstruct
            test_case = 'TestFoamBCMappedInlet.test_mapped_inlet'
        []
    []
    [mapped_mass_flow_subtract]
        [setup]
            type = RunCommand
            command = 'bash -c "foamCleanCase -case foam && blockMesh -case foam && decomposePar -case foam"'
        []
        [run]
            type = RunApp
            input = main.i
            prereq = mapped_mass_flow_receiver/setup
            allow_warnings = true
            min_parallel = 5
            max_parallel = 5
            cli_args = "FoamBCs/tempx/scale_method=subtract FoamBCs/tempy/scale_method=subtract FoamBCs/tempz/scale_method=subtract"
        []
        [reconstruct]
            type = RunCommand
            command = 'reconstructPar -case foam'
            prereq = mapped_mass_flow_receiver/run
        []
        [verify]
            type = PythonUnitTest
            input = test.py
            prereq = mapped_mass_flow_receiver/reconstruct
            test_case = 'TestFoamBCMappedInlet.test_mapped_inlet_subtract'
        []
    []
    [mapped_mass_flow]
        [setup]
            type = RunCommand
            command = 'bash -c "foamCleanCase -case foam && blockMesh -case foam && decomposePar -case foam"'
            prereq = mapped_mass_flow_receiver/reconstruct
        []
        [run]
            type = RunApp
            input = main.i
            prereq = mapped_mass_flow/setup
            allow_warnings = true
            min_parallel = 5
            max_parallel = 5
            cli_args = 'FoamBCs/mass_flowx/pp=pp FoamBCs/tempx/pp=pp FoamBCs/mass_flowy/pp=pp FoamBCs/tempy/pp=pp FoamBCs/mass_flowz/pp=pp FoamBCs/tempz/pp=pp Postprocessors/pp/expression=1'
        []
        [reconstruct]
            type = RunCommand
            command = 'reconstructPar -case foam'
            prereq = mapped_mass_flow/run
        []
        [verify]
            type = PythonUnitTest
            input = test.py
            prereq = mapped_mass_flow/reconstruct
            test_case = 'TestFoamBCMappedInlet.test_mapped_inlet'
        []
    []
    [mapped_rotated]
        [setup]
            type = RunCommand
            command = 'bash -c "foamCleanCase -case foam && blockMesh -case foam &&  transformPoints -case foam "Rz=45" && decomposePar -case foam"'
            prereq = mapped_mass_flow/reconstruct
        []
        [run]
            type = RunApp
            input = main_rotated.i
            prereq = mapped_rotated/setup
            allow_warnings = true
            min_parallel = 5
            max_parallel = 5
        []
        [reconstruct]
            type = RunCommand
            command = 'reconstructPar -case foam'
            prereq = mapped_rotated/run
        []
        [verify]
            type = PythonUnitTest
            input = test.py
            prereq = mapped_rotated/reconstruct
            test_case = 'TestFoamBCMappedInlet.test_mapped_inlet_rotated'
        []
    []
    [face_edge_case]
        [update_mesh]
            type = RunCommand
            command = 'bash -c "foamCleanCase -case foam && cp foam/system/blockMeshDict.face_edge foam/system/blockMeshDict && cp foam/system/decomposeParDict.face_edge foam/system/decomposeParDict"'
            prereq = mapped_rotated/verify
        []
        [setup]
            type = RunCommand
            command = 'bash -c "blockMesh -case foam && decomposePar -case foam"'
            prereq = face_edge_case/update_mesh
        []
        [run]
            type = RunApp
            input = main.i
            prereq = face_edge_case/setup
            allow_warnings = true
            min_parallel = 2
            max_parallel = 2
        []
        [reconstruct]
            type = RunCommand
            command = 'reconstructPar -case foam'
            prereq = face_edge_case/run
        []
        [verify]
            type = PythonUnitTest
            input = test.py
            prereq = face_edge_case/reconstruct
            test_case = 'TestFoamBCMappedInlet.test_mapped_inlet_face_point'
        []
        [reset_mesh]
            type = RunCommand
            command = 'bash -c "cp foam/system/blockMeshDict.orig foam/system/blockMeshDict && cp foam/system/decomposeParDict.orig foam/system/decomposeParDict"'
            prereq = 'face_edge_case/update_mesh'
        []
    []

[]
